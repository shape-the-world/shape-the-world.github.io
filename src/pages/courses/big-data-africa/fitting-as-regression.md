---
id: fitting-as-regression
title: Bayesian regression for 3D shape modelling
--- 

### Bayesian regression for 3D shape modelling

Assume now that we have a deformation model in low-rank form, as discussed in
week 5 of the FutureLearn course:
$$
u[\alpha](x) \sim \mu(x) + \sum_{i=1}^r \alpha_i \sqrt{\lambda_i} \varphi_i(x).
$$
Recall that $$(\lambda_i, \varphi_i)$$ are the eigenfunction/eigenvalue pair of the covariance operator associated with the Gaussian process $$GP(\mu, k)$$. If
$$\alpha_i \sim N(0, 1)$$, then $$u$$ is distributed according to $$GP(\mu, k)$$.
We assumed that any target shape can be generated by applying
a deformation field with the appropriate coefficients $\alpha$. More precisely,
the correct deformation that relates a point $$x_i^T$$ of a given target surface $$\Gamma_T$$  with the corresponding point on the reference surface $$x_i^T$$ is given by
$$
x_i^T = x_i^R + u[\alpha](x_i^R) + \epsilon = x_i^R + \mu(x_i^R) + \sum_{i=1}^n \alpha_i \sqrt{\lambda_i} \varphi_i(x_i^R) + \epsilon
$$
where
$$
\epsilon \sim N(0, \sigma^2 I_{3 \times 3})
$$
is Gaussian noise.
We recognize that this is another linear regression model, as it is linear in the parameters $\alpha_i$.
The corresponding likelihood function is
$$
p(x_i^T | \alpha, x_i^R, \sigma^2) = N(x_i^R + u(x_i)[\alpha], \sigma^2) = N(x_i^R + \mu(x_i^R) + \sum_{j=1}^r \alpha_j \sqrt{\lambda_j} \varphi_j(x_i^R), \sigma^2).
$$
The prior on the shape parameters is, by assumption above,
$$
p(\alpha) = N(0, I_{r \times r}).
$$
For the noise term, we use a log-normal distribution as before
$$
p(\sigma^2) = logNormal(0, 0.25)
$$


It turns out that this is exactly the setting of Gaussian process regression that we discussed in the previous part. However, with this formulation, we hope that it is now easy to see how we can generalize it to include more parameters, change the assumption about the noise or form or the likelihood function, or even relax the assumption of strict correspondence. In all the cases, a closed form solution will not be available anymore
and we will have to resort to computational methods.